(function(h){"function"===typeof define&&define.amd?define(["jquery","datatables.net","datatables.net-buttons"],function(e){return h(e,window,document)}):"object"===typeof exports?module.exports=function(e,f){e||(e=window);if(!f||!f.fn.dataTable)f=require("datatables.net")(e,f).$;f.fn.dataTable.Buttons||require("datatables.net-buttons")(e,f);return h(f,e,e.document)}:h(jQuery,window,document)})(function(h,e,f,j){var k=h.fn.dataTable,n;if("undefined"!==typeof navigator&&/MSIE [1-9]\./.test(navigator.userAgent))n=
void 0;else{var z=e.document,r=z.createElementNS("http://www.w3.org/1999/xhtml","a"),G="download"in r,s=e.webkitRequestFileSystem,A=e.requestFileSystem||s||e.mozRequestFileSystem,H=function(a){(e.setImmediate||e.setTimeout)(function(){throw a;},0)},t=0,u=function(a){var b=function(){"string"===typeof a?(e.URL||e.webkitURL||e).revokeObjectURL(a):a.remove()};e.chrome?b():setTimeout(b,500)},v=function(a,b,d){for(var b=[].concat(b),c=b.length;c--;){var e=a["on"+b[c]];if("function"===typeof e)try{e.call(a,
d||a)}catch(i){H(i)}}},C=function(a){return/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(a.type)?new Blob(["﻿",a],{type:a.type}):a},D=function(a,b){var a=C(a),d=this,c=a.type,B=!1,i,h,f=function(){v(d,["writestart","progress","write","writeend"])},l=function(){if(B||!i)i=(e.URL||e.webkitURL||e).createObjectURL(a);h?h.location.href=i:e.open(i,"_blank")===j&&"undefined"!==typeof safari&&(e.location.href=i);d.readyState=d.DONE;f();u(i)},o=function(a){return function(){if(d.readyState!==
d.DONE)return a.apply(this,arguments)}},g={create:!0,exclusive:!1},q;d.readyState=d.INIT;b||(b="download");if(G)i=(e.URL||e.webkitURL||e).createObjectURL(a),r.href=i,r.download=b,c=z.createEvent("MouseEvents"),c.initMouseEvent("click",!0,!1,e,0,0,0,0,0,!1,!1,!1,!1,0,null),r.dispatchEvent(c),d.readyState=d.DONE,f(),u(i);else{e.chrome&&(c&&"application/octet-stream"!==c)&&(q=a.slice||a.webkitSlice,a=q.call(a,0,a.size,"application/octet-stream"),B=!0);s&&"download"!==b&&(b+=".download");if("application/octet-stream"===
c||s)h=e;A?(t+=a.size,A(e.TEMPORARY,t,o(function(c){c.root.getDirectory("saved",g,o(function(c){var e=function(){c.getFile(b,g,o(function(b){b.createWriter(o(function(c){c.onwriteend=function(a){h.location.href=b.toURL();d.readyState=d.DONE;v(d,"writeend",a);u(b)};c.onerror=function(){var a=c.error;a.code!==a.ABORT_ERR&&l()};["writestart","progress","write","abort"].forEach(function(a){c["on"+a]=d["on"+a]});c.write(a);d.abort=function(){c.abort();d.readyState=d.DONE};d.readyState=d.WRITING}),l)}),
l)};c.getFile(b,{create:false},o(function(a){a.remove();e()}),o(function(a){a.code===a.NOT_FOUND_ERR?e():l()}))}),l)}),l)):l()}},g=D.prototype;"undefined"!==typeof navigator&&navigator.msSaveOrOpenBlob?n=function(a,b){return navigator.msSaveOrOpenBlob(C(a),b)}:(g.abort=function(){this.readyState=this.DONE;v(this,"abort")},g.readyState=g.INIT=0,g.WRITING=1,g.DONE=2,g.error=g.onwritestart=g.onprogress=g.onwrite=g.onabort=g.onerror=g.onwriteend=null,n=function(a,b){return new D(a,b)})}var x=function(a,
b){var d="*"===a.filename&&"*"!==a.title&&a.title!==j?a.title:a.filename;"function"===typeof d&&(d=d());-1!==d.indexOf("*")&&(d=d.replace("*",h("title").text()));d=d.replace(/[^a-zA-Z0-9_\u00A1-\uFFFF\.,\-_ !\(\)]/g,"");return b===j||!0===b?d+a.extension:d},I=function(a){var b="Sheet1";a.sheetName&&(b=a.sheetName.replace(/[\[\]\*\/\\\?\:]/g,""));return b},J=function(a){a=a.title;"function"===typeof a&&(a=a());return-1!==a.indexOf("*")?a.replace("*",h("title").text()):a},y=function(a){return a.newline?
a.newline:navigator.userAgent.match(/Windows/)?"\r\n":"\n"},E=function(a,b){for(var d=y(b),c=a.buttons.exportData(b.exportOptions),e=b.fieldBoundary,i=b.fieldSeparator,h=RegExp(e,"g"),f=b.escapeChar!==j?b.escapeChar:"\\",g=function(a){for(var b="",c=0,d=a.length;c<d;c++)0<c&&(b+=i),b+=e?e+(""+a[c]).replace(h,f+e)+e:a[c];return b},o=b.header?g(c.header)+d:"",n=b.footer&&c.footer?d+g(c.footer):"",q=[],w=0,p=c.body.length;w<p;w++)q.push(g(c.body[w]));return{str:o+q.join(d)+n,rows:q.length}},F=function(){return-1!==
navigator.userAgent.indexOf("Safari")&&-1===navigator.userAgent.indexOf("Chrome")&&-1===navigator.userAgent.indexOf("Opera")},p={"_rels/.rels":'<?xml version="1.0" encoding="UTF-8" standalone="yes"?><Relationships xmlns="http://schemas.openxmlformats.org/package/2006/relationships">\t<Relationship Id="rId1" Type="http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument" Target="xl/workbook.xml"/></Relationships>',"xl/_rels/workbook.xml.rels":'<?xml version="1.0" encoding="UTF-8" standalone="yes"?><Relationships xmlns="http://schemas.openxmlformats.org/package/2006/relationships">\t<Relationship Id="rId1" Type="http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet" Target="worksheets/sheet1.xml"/>\t<Relationship Id="rId2" Type="http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles" Target="styles.xml"/></Relationships>',
"[Content_Types].xml":'<?xml version="1.0" encoding="UTF-8" standalone="yes"?><Types xmlns="http://schemas.openxmlformats.org/package/2006/content-types">\t\t<Default Extension="xml" ContentType="application/xml"/>\t<Default Extension="rels" ContentType="application/vnd.openxmlformats-package.relationships+xml"/>\t\t<Default Extension="jpeg" ContentType="image/jpeg"/>\t<Override PartName="/xl/workbook.xml" ContentType="application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml"/>\t\t\t<Override PartName="/xl/worksheets/sheet1.xml" ContentType="application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml"/>\t\t<Override PartName="/xl/styles.xml" ContentType="application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml"/></Types>',
"xl/workbook.xml":'<?xml version="1.0" encoding="UTF-8" standalone="yes"?><workbook xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:r="http://schemas.openxmlformats.org/officeDocument/2006/relationships">\t<fileVersion appName="xl" lastEdited="5" lowestEdited="5" rupBuild="24816"/>\t<workbookPr showInkAnnotation="0" autoCompressPictures="0"/>\t<bookViews>\t\t<workbookView xWindow="0" yWindow="0" windowWidth="25600" windowHeight="19020" tabRatio="500"/>\t</bookViews>\t<sheets>\t\t<sheet name="__SHEET_NAME__" sheetId="1" r:id="rId1"/>\t</sheets></workbook>',
"xl/worksheets/sheet1.xml":'<?xml version="1.0" encoding="UTF-8" standalone="yes"?><worksheet xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:r="http://schemas.openxmlformats.org/officeDocument/2006/relationships" xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" mc:Ignorable="x14ac" xmlns:x14ac="http://schemas.microsoft.com/office/spreadsheetml/2009/9/ac">\t<sheetData>\t\t__DATA__\t</sheetData></worksheet>',"xl/styles.xml":'<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\t <styleSheet xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main"><numFmts count="1"><numFmt numFmtId="164" formatCode="General"/></numFmts><fonts count="5"><font><sz val="10"/><name val="Arial"/><family val="2"/></font><font><sz val="10"/><name val="Arial"/><family val="0"/></font><font><sz val="10"/><name val="Arial"/><family val="0"/></font><font><sz val="10"/><name val="Arial"/><family val="0"/></font><font><b val="true"/><sz val="10"/><name val="Arial"/><family val="2"/></font></fonts><fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills><borders count="1"><border diagonalUp="false" diagonalDown="false"><left/><right/><top/><bottom/><diagonal/></border></borders><cellStyleXfs count="20"><xf numFmtId="164" fontId="0" fillId="0" borderId="0" applyFont="true" applyBorder="true" applyAlignment="true" applyProtection="true"><alignment horizontal="general" vertical="bottom" textRotation="0" wrapText="false" indent="0" shrinkToFit="false"/><protection locked="true" hidden="false"/></xf><xf numFmtId="0" fontId="1" fillId="0" borderId="0" applyFont="true" applyBorder="false" applyAlignment="false" applyProtection="false"></xf><xf numFmtId="0" fontId="1" fillId="0" borderId="0" applyFont="true" applyBorder="false" applyAlignment="false" applyProtection="false"></xf><xf numFmtId="0" fontId="2" fillId="0" borderId="0" applyFont="true" applyBorder="false" applyAlignment="false" applyProtection="false"></xf><xf numFmtId="0" fontId="2" fillId="0" borderId="0" applyFont="true" applyBorder="false" applyAlignment="false" applyProtection="false"></xf><xf numFmtId="0" fontId="0" fillId="0" borderId="0" applyFont="true" applyBorder="false" applyAlignment="false" applyProtection="false"></xf><xf numFmtId="0" fontId="0" fillId="0" borderId="0" applyFont="true" applyBorder="false" applyAlignment="false" applyProtection="false"></xf><xf numFmtId="0" fontId="0" fillId="0" borderId="0" applyFont="true" applyBorder="false" applyAlignment="false" applyProtection="false"></xf><xf numFmtId="0" fontId="0" fillId="0" borderId="0" applyFont="true" applyBorder="false" applyAlignment="false" applyProtection="false"></xf><xf numFmtId="0" fontId="0" fillId="0" borderId="0" applyFont="true" applyBorder="false" applyAlignment="false" applyProtection="false"></xf><xf numFmtId="0" fontId="0" fillId="0" borderId="0" applyFont="true" applyBorder="false" applyAlignment="false" applyProtection="false"></xf><xf numFmtId="0" fontId="0" fillId="0" borderId="0" applyFont="true" applyBorder="false" applyAlignment="false" applyProtection="false"></xf><xf numFmtId="0" fontId="0" fillId="0" borderId="0" applyFont="true" applyBorder="false" applyAlignment="false" applyProtection="false"></xf><xf numFmtId="0" fontId="0" fillId="0" borderId="0" applyFont="true" applyBorder="false" applyAlignment="false" applyProtection="false"></xf><xf numFmtId="0" fontId="0" fillId="0" borderId="0" applyFont="true" applyBorder="false" applyAlignment="false" applyProtection="false"></xf><xf numFmtId="43" fontId="1" fillId="0" borderId="0" applyFont="true" applyBorder="false" applyAlignment="false" applyProtection="false"></xf><xf numFmtId="41" fontId="1" fillId="0" borderId="0" applyFont="true" applyBorder="false" applyAlignment="false" applyProtection="false"></xf><xf numFmtId="44" fontId="1" fillId="0" borderId="0" applyFont="true" applyBorder="false" applyAlignment="false" applyProtection="false"></xf><xf numFmtId="42" fontId="1" fillId="0" borderId="0" applyFont="true" applyBorder="false" applyAlignment="false" applyProtection="false"></xf><xf numFmtId="9" fontId="1" fillId="0" borderId="0" applyFont="true" applyBorder="false" applyAlignment="false" applyProtection="false"></xf></cellStyleXfs><cellXfs count="2"><xf numFmtId="164" fontId="0" fillId="0" borderId="0" xfId="0" applyFont="false" applyBorder="false" applyAlignment="false" applyProtection="false"><alignment horizontal="general" vertical="bottom" textRotation="0" wrapText="false" indent="0" shrinkToFit="false"/><protection locked="true" hidden="false"/></xf><xf numFmtId="164" fontId="4" fillId="0" borderId="0" xfId="0" applyFont="true" applyBorder="false" applyAlignment="false" applyProtection="false"><alignment horizontal="general" vertical="bottom" textRotation="0" wrapText="false" indent="0" shrinkToFit="false"/><protection locked="true" hidden="false"/></xf></cellXfs><cellStyles count="6"><cellStyle name="Normal" xfId="0" builtinId="0" customBuiltin="false"/><cellStyle name="Comma" xfId="15" builtinId="3" customBuiltin="false"/><cellStyle name="Comma [0]" xfId="16" builtinId="6" customBuiltin="false"/><cellStyle name="Currency" xfId="17" builtinId="4" customBuiltin="false"/><cellStyle name="Currency [0]" xfId="18" builtinId="7" customBuiltin="false"/><cellStyle name="Percent" xfId="19" builtinId="5" customBuiltin="false"/></cellStyles></styleSheet>'};
k.ext.buttons.copyHtml5={className:"buttons-copy buttons-html5",text:function(a){return a.i18n("buttons.copy","Copy")},action:function(a,b,d,c){var a=E(b,c),e=a.str,d=h("<div/>").css({height:1,width:1,overflow:"hidden",position:"fixed",top:0,left:0});c.customize&&(e=c.customize(e,c));c=h("<textarea readonly/>").val(e).appendTo(d);if(f.queryCommandSupported("copy")){d.appendTo(b.table().container());c[0].focus();c[0].select();try{f.execCommand("copy");d.remove();b.buttons.info(b.i18n("buttons.copyTitle",
"Copy to clipboard"),b.i18n("buttons.copySuccess",{1:"Copied one row to clipboard",_:"Copied %d rows to clipboard"},a.rows),2E3);return}catch(i){}}a=h("<span>"+b.i18n("buttons.copyKeys","Press <i>ctrl</i> or <i>⌘</i> + <i>C</i> to copy the table data<br>to your system clipboard.<br><br>To cancel, click this message or press escape.")+"</span>").append(d);b.buttons.info(b.i18n("buttons.copyTitle","Copy to clipboard"),a,0);c[0].focus();c[0].select();var g=h(a).closest(".dt-button-info"),j=function(){g.off("click.buttons-copy");
h(f).off(".buttons-copy");b.buttons.info(!1)};g.on("click.buttons-copy",j);h(f).on("keydown.buttons-copy",function(a){27===a.keyCode&&j()}).on("copy.buttons-copy cut.buttons-copy",function(){j()})},exportOptions:{},fieldSeparator:"\t",fieldBoundary:"",header:!0,footer:!1};k.ext.buttons.csvHtml5={className:"buttons-csv buttons-html5",available:function(){return e.FileReader!==j&&e.Blob},text:function(a){return a.i18n("buttons.csv","CSV")},action:function(a,b,d,c){y(c);a=E(b,c).str;b=c.charset;c.customize&&
(a=c.customize(a,c));!1!==b?(b||(b=f.characterSet||f.charset),b&&(b=";charset="+b)):b="";n(new Blob([a],{type:"text/csv"+b}),x(c))},filename:"*",extension:".csv",exportOptions:{},fieldSeparator:",",fieldBoundary:'"',escapeChar:'"',charset:null,header:!0,footer:!1};k.ext.buttons.excelHtml5={className:"buttons-excel buttons-html5",available:function(){return e.FileReader!==j&&e.JSZip!==j&&!F()},text:function(a){return a.i18n("buttons.excel","Excel")},action:function(a,b,d,c){var g=h.parseXML(p["xl/worksheets/sheet1.xml"]),
a=b.buttons.exportData(c.exportOptions),i,b=function(a,b){var c=g.createElement("row");g.getElementsByTagName("sheetData")[0].appendChild(c);b!==j&&(i=b+1,c.setAttribute("r",i));for(var d=0,e=a.length;d<e;d++){if(null===a[d]||a[d]===j)a[d]="";var f,m,k,l;f=d;for(m="";0<=f;)m=String.fromCharCode(f%26+65)+m,f=Math.floor(f/26)-1;m=m+""+i;"number"===typeof a[d]||a[d].match&&h.trim(a[d]).match(/^-?\d+(\.\d+)?$/)&&"0"!==a[d].charAt(0)?(f=g.createElement("c"),f.setAttribute("t","n"),f.setAttribute("r",m),
m=g.createElement("v"),k=g.createTextNode(a[d]),f.appendChild(m)):(f=g.createElement("c"),f.setAttribute("t","inlineStr"),f.setAttribute("r",m),l=g.createElement("is"),m=g.createElement("t"),k=g.createTextNode(!a[d].replace?a[d]:a[d].replace(/&(?!amp;)/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/[\x00-\x09\x0B\x0C\x0E-\x1F\x7F-\x9F]/g,"")),f.appendChild(l),l.appendChild(m));m.appendChild(k);c.appendChild(f)}};c.customizeData&&c.customizeData(a);if(c.header){b(a.header,0);for(var d=
g.getElementsByTagName("row")[0].childNodes,f=0,k=d.length;f<k;f++)"c"===d[f].nodeName&&d[f].setAttribute("s","1")}d=0;for(f=a.body.length;d<f;d++)b(a.body[d],d+1);c.footer&&b(a.footer);var a=new e.JSZip,b=a.folder("_rels"),d=a.folder("xl"),f=a.folder("xl/_rels"),k=a.folder("xl/worksheets"),l=(new XMLSerializer).serializeToString(g);a.file("[Content_Types].xml",p["[Content_Types].xml"]);b.file(".rels",p["_rels/.rels"]);d.file("workbook.xml",p["xl/workbook.xml"].replace("__SHEET_NAME__",I(c)));d.file("styles.xml",
p["xl/styles.xml"]);f.file("workbook.xml.rels",p["xl/_rels/workbook.xml.rels"]);k.file("sheet1.xml",l);n(a.generate({type:"blob",mimeType:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}),x(c))},filename:"*",extension:".xlsx",exportOptions:{},header:!0,footer:!1};k.ext.buttons.pdfHtml5={className:"buttons-pdf buttons-html5",available:function(){return e.FileReader!==j&&e.pdfMake},text:function(a){return a.i18n("buttons.pdf","PDF")},action:function(a,b,d,c){y(c);a=b.buttons.exportData(c.exportOptions);
b=[];c.header&&b.push(h.map(a.header,function(a){return{text:"string"===typeof a?a:a+"",style:"tableHeader"}}));for(var f=0,d=a.body.length;f<d;f++)b.push(h.map(a.body[f],function(a){return{text:"string"===typeof a?a:a+"",style:f%2?"tableBodyEven":"tableBodyOdd"}}));c.footer&&b.push(h.map(a.footer,function(a){return{text:"string"===typeof a?a:a+"",style:"tableFooter"}}));a={pageSize:c.pageSize,pageOrientation:c.orientation,content:[{table:{headerRows:1,body:b},layout:"noBorders"}],styles:{tableHeader:{bold:!0,
fontSize:11,color:"white",fillColor:"#2d4154",alignment:"center"},tableBodyEven:{},tableBodyOdd:{fillColor:"#f3f3f3"},tableFooter:{bold:!0,fontSize:11,color:"white",fillColor:"#2d4154"},title:{alignment:"center",fontSize:15},message:{}},defaultStyle:{fontSize:10}};c.message&&a.content.unshift({text:c.message,style:"message",margin:[0,0,0,12]});c.title&&a.content.unshift({text:J(c,!1),style:"title",margin:[0,0,0,12]});c.customize&&c.customize(a,c);a=e.pdfMake.createPdf(a);"open"===c.download&&!F()?
a.open():a.getBuffer(function(a){a=new Blob([a],{type:"application/pdf"});n(a,x(c))})},title:"*",filename:"*",extension:".pdf",exportOptions:{},orientation:"portrait",pageSize:"A4",header:!0,footer:!1,message:null,customize:null,download:"download"};return k.Buttons});
