/*!
 HTML5 export buttons for Buttons and DataTables.
 2016 SpryMedia Ltd - datatables.net/license

 FileSaver.js (1.3.3) - MIT license
 Copyright © 2016 Eli Grey - http://eligrey.com
*/
(function(m){"function"===typeof define&&define.amd?define(["jquery","datatables.net","datatables.net-buttons"],function(t){return m(t,window,document)}):"object"===typeof exports?module.exports=function(t,v,E,F){t||(t=window);v&&v.fn.dataTable||(v=require("datatables.net")(t,v).$);v.fn.dataTable.Buttons||require("datatables.net-buttons")(t,v);return m(v,t,t.document,E,F)}:m(jQuery,window,document)})(function(m,t,v,E,F,y){function K(a,c){G===y&&(G=-1===J.serializeToString(m.parseXML(L["xl/worksheets/sheet1.xml"])).indexOf("xmlns:r"));
m.each(c,function(d,b){if(m.isPlainObject(b))d=a.folder(d),K(d,b);else{if(G){var r=b.childNodes[0],e,h=[];for(e=r.attributes.length-1;0<=e;e--){var p=r.attributes[e].nodeName;var k=r.attributes[e].nodeValue;-1!==p.indexOf(":")&&(h.push({name:p,value:k}),r.removeAttribute(p))}e=0;for(p=h.length;e<p;e++)k=b.createAttribute(h[e].name.replace(":","_dt_b_namespace_token_")),k.value=h[e].value,r.setAttributeNode(k)}b=J.serializeToString(b);G&&(-1===b.indexOf("<?xml")&&(b='<?xml version="1.0" encoding="UTF-8" standalone="yes"?>'+
b),b=b.replace(/_dt_b_namespace_token_/g,":"));b=b.replace(/<([^<>]*?) xmlns=""([^<>]*?)>/g,"<$1 $2>");a.file(d,b)}})}function z(a,c,d){var b=a.createElement(c);d&&(d.attr&&m(b).attr(d.attr),d.children&&m.each(d.children,function(r,e){b.appendChild(e)}),d.text&&b.appendChild(a.createTextNode(d.text)));return b}function P(a,c){var d=a.header[c].length;a.footer&&a.footer[c].length>d&&(d=a.footer[c].length);for(var b=0,r=a.body.length;b<r;b++){var e=a.body[b][c];e=null!==e&&e!==y?e.toString():"";-1!==
e.indexOf("\n")?(e=e.split("\n"),e.sort(function(h,p){return p.length-h.length}),e=e[0].length):e=e.length;e>d&&(d=e);if(40<d)return 52}d*=1.3;return 6<d?d:6}var C=m.fn.dataTable,D=function(a){if(!("undefined"===typeof a||"undefined"!==typeof navigator&&/MSIE [1-9]\./.test(navigator.userAgent))){var c=a.document.createElementNS("http://www.w3.org/1999/xhtml","a"),d="download"in c,b=/constructor/i.test(a.HTMLElement)||a.safari,r=/CriOS\/[\d]+/.test(navigator.userAgent),e=function(f){(a.setImmediate||
a.setTimeout)(function(){throw f;},0)},h=function(f){setTimeout(function(){"string"===typeof f?(a.URL||a.webkitURL||a).revokeObjectURL(f):f.remove()},4E4)},p=function(f){return/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(f.type)?new Blob([String.fromCharCode(65279),f],{type:f.type}):f},k=function(f,x,l){l||(f=p(f));var g=this,A="application/octet-stream"===f.type,w=function(){var q=["writestart","progress","write","writeend"];q=[].concat(q);for(var B=q.length;B--;){var H=
g["on"+q[B]];if("function"===typeof H)try{H.call(g,g)}catch(Q){e(Q)}}};g.readyState=g.INIT;if(d){var u=(a.URL||a.webkitURL||a).createObjectURL(f);setTimeout(function(){c.href=u;c.download=x;var q=new MouseEvent("click");c.dispatchEvent(q);w();h(u);g.readyState=g.DONE})}else(function(){if((r||A&&b)&&a.FileReader){var q=new FileReader;q.onloadend=function(){var B=r?q.result:q.result.replace(/^data:[^;]*;/,"data:attachment/file;");a.open(B,"_blank")||(a.location.href=B);g.readyState=g.DONE;w()};q.readAsDataURL(f);
g.readyState=g.INIT}else u||(u=(a.URL||a.webkitURL||a).createObjectURL(f)),A?a.location.href=u:a.open(u,"_blank")||(a.location.href=u),g.readyState=g.DONE,w(),h(u)})()},n=k.prototype;if("undefined"!==typeof navigator&&navigator.msSaveOrOpenBlob)return function(f,x,l){x=x||f.name||"download";l||(f=p(f));return navigator.msSaveOrOpenBlob(f,x)};n.abort=function(){};n.readyState=n.INIT=0;n.WRITING=1;n.DONE=2;n.error=n.onwritestart=n.onprogress=n.onwrite=n.onabort=n.onerror=n.onwriteend=null;return function(f,
x,l){return new k(f,x||f.name||"download",l)}}}("undefined"!==typeof self&&self||"undefined"!==typeof t&&t||this.content);C.fileSave=D;var I=function(a,c){var d="*"===a.filename&&"*"!==a.title&&a.title!==y?a.title:a.filename;"function"===typeof d&&(d=d());-1!==d.indexOf("*")&&(d=m.trim(d.replace("*",m("title").text())));d=d.replace(/[^a-zA-Z0-9_\u00A1-\uFFFF\.,\-_ !\(\)]/g,"");return c===y||!0===c?d+a.extension:d},R=function(a){var c="Sheet1";a.sheetName&&(c=a.sheetName.replace(/[\[\]\*\/\\\?:]/g,
""));return c},S=function(a){a=a.title;"function"===typeof a&&(a=a());return-1!==a.indexOf("*")?a.replace("*",m("title").text()||"Exported data"):a},M=function(a,c){var d=c.newline?c.newline:navigator.userAgent.match(/Windows/)?"\r\n":"\n";a=a.buttons.exportData(c.exportOptions);var b=c.fieldBoundary,r=c.fieldSeparator,e=new RegExp(b,"g"),h=c.escapeChar!==y?c.escapeChar:"\\",p=function(l){for(var g="",A=0,w=l.length;A<w;A++)0<A&&(g+=r),g+=b?b+(""+l[A]).replace(e,h+b)+b:l[A];return g},k=c.header?p(a.header)+
d:"";c=c.footer&&a.footer?d+p(a.footer):"";for(var n=[],f=0,x=a.body.length;f<x;f++)n.push(p(a.body[f]));return{str:k+n.join(d)+c,rows:n.length}},N=function(){if(-1===navigator.userAgent.indexOf("Safari")||-1!==navigator.userAgent.indexOf("Chrome")||-1!==navigator.userAgent.indexOf("Opera"))return!1;var a=navigator.userAgent.match(/AppleWebKit\/(\d+\.\d+)/);return a&&1<a.length&&603.1>1*a[1]?!0:!1};try{var J=new XMLSerializer,G}catch(a){}var L={"_rels/.rels":'<?xml version="1.0" encoding="UTF-8" standalone="yes"?><Relationships xmlns="http://schemas.openxmlformats.org/package/2006/relationships"><Relationship Id="rId1" Type="http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument" Target="xl/workbook.xml"/></Relationships>',
"xl/_rels/workbook.xml.rels":'<?xml version="1.0" encoding="UTF-8" standalone="yes"?><Relationships xmlns="http://schemas.openxmlformats.org/package/2006/relationships"><Relationship Id="rId1" Type="http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet" Target="worksheets/sheet1.xml"/><Relationship Id="rId2" Type="http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles" Target="styles.xml"/></Relationships>',"[Content_Types].xml":'<?xml version="1.0" encoding="UTF-8" standalone="yes"?><Types xmlns="http://schemas.openxmlformats.org/package/2006/content-types"><Default Extension="xml" ContentType="application/xml" /><Default Extension="rels" ContentType="application/vnd.openxmlformats-package.relationships+xml" /><Default Extension="jpeg" ContentType="image/jpeg" /><Override PartName="/xl/workbook.xml" ContentType="application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml" /><Override PartName="/xl/worksheets/sheet1.xml" ContentType="application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml" /><Override PartName="/xl/styles.xml" ContentType="application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml" /></Types>',
"xl/workbook.xml":'<?xml version="1.0" encoding="UTF-8" standalone="yes"?><workbook xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:r="http://schemas.openxmlformats.org/officeDocument/2006/relationships"><fileVersion appName="xl" lastEdited="5" lowestEdited="5" rupBuild="24816"/><workbookPr showInkAnnotation="0" autoCompressPictures="0"/><bookViews><workbookView xWindow="0" yWindow="0" windowWidth="25600" windowHeight="19020" tabRatio="500"/></bookViews><sheets><sheet name="" sheetId="1" r:id="rId1"/></sheets></workbook>',
"xl/worksheets/sheet1.xml":'<?xml version="1.0" encoding="UTF-8" standalone="yes"?><worksheet xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:r="http://schemas.openxmlformats.org/officeDocument/2006/relationships" xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" mc:Ignorable="x14ac" xmlns:x14ac="http://schemas.microsoft.com/office/spreadsheetml/2009/9/ac"><sheetData/></worksheet>',"xl/styles.xml":'<?xml version="1.0" encoding="UTF-8"?><styleSheet xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" mc:Ignorable="x14ac" xmlns:x14ac="http://schemas.microsoft.com/office/spreadsheetml/2009/9/ac"><numFmts count="6"><numFmt numFmtId="164" formatCode="#,##0.00_- [$$-45C]"/><numFmt numFmtId="165" formatCode="&quot;£&quot;#,##0.00"/><numFmt numFmtId="166" formatCode="[$€-2] #,##0.00"/><numFmt numFmtId="167" formatCode="0.0%"/><numFmt numFmtId="168" formatCode="#,##0;(#,##0)"/><numFmt numFmtId="169" formatCode="#,##0.00;(#,##0.00)"/></numFmts><fonts count="5" x14ac:knownFonts="1"><font><sz val="11" /><name val="Calibri" /></font><font><sz val="11" /><name val="Calibri" /><color rgb="FFFFFFFF" /></font><font><sz val="11" /><name val="Calibri" /><b /></font><font><sz val="11" /><name val="Calibri" /><i /></font><font><sz val="11" /><name val="Calibri" /><u /></font></fonts><fills count="6"><fill><patternFill patternType="none" /></fill><fill/><fill><patternFill patternType="solid"><fgColor rgb="FFD9D9D9" /><bgColor indexed="64" /></patternFill></fill><fill><patternFill patternType="solid"><fgColor rgb="FFD99795" /><bgColor indexed="64" /></patternFill></fill><fill><patternFill patternType="solid"><fgColor rgb="ffc6efce" /><bgColor indexed="64" /></patternFill></fill><fill><patternFill patternType="solid"><fgColor rgb="ffc6cfef" /><bgColor indexed="64" /></patternFill></fill></fills><borders count="2"><border><left /><right /><top /><bottom /><diagonal /></border><border diagonalUp="false" diagonalDown="false"><left style="thin"><color auto="1" /></left><right style="thin"><color auto="1" /></right><top style="thin"><color auto="1" /></top><bottom style="thin"><color auto="1" /></bottom><diagonal /></border></borders><cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0" /></cellStyleXfs><cellXfs count="67"><xf numFmtId="0" fontId="0" fillId="0" borderId="0" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="1" fillId="0" borderId="0" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="2" fillId="0" borderId="0" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="3" fillId="0" borderId="0" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="4" fillId="0" borderId="0" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="0" fillId="2" borderId="0" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="1" fillId="2" borderId="0" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="2" fillId="2" borderId="0" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="3" fillId="2" borderId="0" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="4" fillId="2" borderId="0" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="0" fillId="3" borderId="0" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="1" fillId="3" borderId="0" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="2" fillId="3" borderId="0" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="3" fillId="3" borderId="0" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="4" fillId="3" borderId="0" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="0" fillId="4" borderId="0" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="1" fillId="4" borderId="0" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="2" fillId="4" borderId="0" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="3" fillId="4" borderId="0" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="4" fillId="4" borderId="0" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="0" fillId="5" borderId="0" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="1" fillId="5" borderId="0" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="2" fillId="5" borderId="0" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="3" fillId="5" borderId="0" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="4" fillId="5" borderId="0" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="0" fillId="0" borderId="1" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="1" fillId="0" borderId="1" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="2" fillId="0" borderId="1" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="3" fillId="0" borderId="1" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="4" fillId="0" borderId="1" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="0" fillId="2" borderId="1" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="1" fillId="2" borderId="1" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="2" fillId="2" borderId="1" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="3" fillId="2" borderId="1" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="4" fillId="2" borderId="1" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="0" fillId="3" borderId="1" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="1" fillId="3" borderId="1" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="2" fillId="3" borderId="1" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="3" fillId="3" borderId="1" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="4" fillId="3" borderId="1" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="0" fillId="4" borderId="1" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="1" fillId="4" borderId="1" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="2" fillId="4" borderId="1" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="3" fillId="4" borderId="1" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="4" fillId="4" borderId="1" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="0" fillId="5" borderId="1" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="1" fillId="5" borderId="1" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="2" fillId="5" borderId="1" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="3" fillId="5" borderId="1" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="4" fillId="5" borderId="1" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="0" fillId="0" borderId="0" applyFont="1" applyFill="1" applyBorder="1" xfId="0" applyAlignment="1"><alignment horizontal="left"/></xf><xf numFmtId="0" fontId="0" fillId="0" borderId="0" applyFont="1" applyFill="1" applyBorder="1" xfId="0" applyAlignment="1"><alignment horizontal="center"/></xf><xf numFmtId="0" fontId="0" fillId="0" borderId="0" applyFont="1" applyFill="1" applyBorder="1" xfId="0" applyAlignment="1"><alignment horizontal="right"/></xf><xf numFmtId="0" fontId="0" fillId="0" borderId="0" applyFont="1" applyFill="1" applyBorder="1" xfId="0" applyAlignment="1"><alignment horizontal="fill"/></xf><xf numFmtId="0" fontId="0" fillId="0" borderId="0" applyFont="1" applyFill="1" applyBorder="1" xfId="0" applyAlignment="1"><alignment textRotation="90"/></xf><xf numFmtId="0" fontId="0" fillId="0" borderId="0" applyFont="1" applyFill="1" applyBorder="1" xfId="0" applyAlignment="1"><alignment wrapText="1"/></xf><xf numFmtId="9"   fontId="0" fillId="0" borderId="0" applyFont="1" applyFill="1" applyBorder="1" xfId="0" applyNumberFormat="1"/><xf numFmtId="164" fontId="0" fillId="0" borderId="0" applyFont="1" applyFill="1" applyBorder="1" xfId="0" applyNumberFormat="1"/><xf numFmtId="165" fontId="0" fillId="0" borderId="0" applyFont="1" applyFill="1" applyBorder="1" xfId="0" applyNumberFormat="1"/><xf numFmtId="166" fontId="0" fillId="0" borderId="0" applyFont="1" applyFill="1" applyBorder="1" xfId="0" applyNumberFormat="1"/><xf numFmtId="167" fontId="0" fillId="0" borderId="0" applyFont="1" applyFill="1" applyBorder="1" xfId="0" applyNumberFormat="1"/><xf numFmtId="168" fontId="0" fillId="0" borderId="0" applyFont="1" applyFill="1" applyBorder="1" xfId="0" applyNumberFormat="1"/><xf numFmtId="169" fontId="0" fillId="0" borderId="0" applyFont="1" applyFill="1" applyBorder="1" xfId="0" applyNumberFormat="1"/><xf numFmtId="3" fontId="0" fillId="0" borderId="0" applyFont="1" applyFill="1" applyBorder="1" xfId="0" applyNumberFormat="1"/><xf numFmtId="4" fontId="0" fillId="0" borderId="0" applyFont="1" applyFill="1" applyBorder="1" xfId="0" applyNumberFormat="1"/><xf numFmtId="1" fontId="0" fillId="0" borderId="0" applyFont="1" applyFill="1" applyBorder="1" xfId="0" applyNumberFormat="1"/><xf numFmtId="2" fontId="0" fillId="0" borderId="0" applyFont="1" applyFill="1" applyBorder="1" xfId="0" applyNumberFormat="1"/></cellXfs><cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0" /></cellStyles><dxfs count="0" /><tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4" /></styleSheet>'},
O=[{match:/^\-?\d+\.\d%$/,style:60,fmt:function(a){return a/100}},{match:/^\-?\d+\.?\d*%$/,style:56,fmt:function(a){return a/100}},{match:/^\-?\$[\d,]+.?\d*$/,style:57},{match:/^\-?£[\d,]+.?\d*$/,style:58},{match:/^\-?€[\d,]+.?\d*$/,style:59},{match:/^\-?\d+$/,style:65},{match:/^\-?\d+\.\d{2}$/,style:66},{match:/^\([\d,]+\)$/,style:61,fmt:function(a){return-1*a.replace(/[\(\)]/g,"")}},{match:/^\([\d,]+\.\d{2}\)$/,style:62,fmt:function(a){return-1*a.replace(/[\(\)]/g,"")}},{match:/^\-?[\d,]+$/,style:63},
{match:/^\-?[\d,]+\.\d{2}$/,style:64}];C.ext.buttons.copyHtml5={className:"buttons-copy buttons-html5",text:function(a){return a.i18n("buttons.copy","Copy")},action:function(a,c,d,b){this.processing(!0);var r=this;a=M(c,b);var e=a.str;d=m("<div/>").css({height:1,width:1,overflow:"hidden",position:"fixed",top:0,left:0});b.customize&&(e=b.customize(e,b));b=m("<textarea readonly/>").val(e).appendTo(d);if(v.queryCommandSupported("copy")){d.appendTo(c.table().container());b[0].focus();b[0].select();try{var h=
v.execCommand("copy");d.remove();if(h){c.buttons.info(c.i18n("buttons.copyTitle","Copy to clipboard"),c.i18n("buttons.copySuccess",{1:"Copied one row to clipboard",_:"Copied %d rows to clipboard"},a.rows),2E3);this.processing(!1);return}}catch(n){}}h=m("<span>"+c.i18n("buttons.copyKeys","Press <i>ctrl</i> or <i>⌘</i> + <i>C</i> to copy the table data<br>to your system clipboard.<br><br>To cancel, click this message or press escape.")+"</span>").append(d);c.buttons.info(c.i18n("buttons.copyTitle",
"Copy to clipboard"),h,0);b[0].focus();b[0].select();var p=m(h).closest(".dt-button-info"),k=function(){p.off("click.buttons-copy");m(v).off(".buttons-copy");c.buttons.info(!1)};p.on("click.buttons-copy",k);m(v).on("keydown.buttons-copy",function(n){27===n.keyCode&&(k(),r.processing(!1))}).on("copy.buttons-copy cut.buttons-copy",function(){k();r.processing(!1)})},exportOptions:{},fieldSeparator:"\t",fieldBoundary:"",header:!0,footer:!1};C.ext.buttons.csvHtml5={bom:!1,className:"buttons-csv buttons-html5",
available:function(){return t.FileReader!==y&&t.Blob},text:function(a){return a.i18n("buttons.csv","CSV")},action:function(a,c,d,b){this.processing(!0);a=M(c,b).str;c=b.charset;b.customize&&(a=b.customize(a,b));!1!==c?(c||(c=v.characterSet||v.charset),c&&(c=";charset="+c)):c="";b.bom&&(a="﻿"+a);D(new Blob([a],{type:"text/csv"+c}),I(b),!0);this.processing(!1)},filename:"*",extension:".csv",exportOptions:{},fieldSeparator:",",fieldBoundary:'"',escapeChar:'"',charset:null,header:!0,footer:!1};C.ext.buttons.excelHtml5=
{className:"buttons-excel buttons-html5",available:function(){return t.FileReader!==y&&(E||t.JSZip)!==y&&!N()&&J},text:function(a){return a.i18n("buttons.excel","Excel")},action:function(a,c,d,b){this.processing(!0);var r=this,e=0;a=function(l){return m.parseXML(L[l])};var h=a("xl/worksheets/sheet1.xml"),p=h.getElementsByTagName("sheetData")[0];a={_rels:{".rels":a("_rels/.rels")},xl:{_rels:{"workbook.xml.rels":a("xl/_rels/workbook.xml.rels")},"workbook.xml":a("xl/workbook.xml"),"styles.xml":a("xl/styles.xml"),
worksheets:{"sheet1.xml":h}},"[Content_Types].xml":a("[Content_Types].xml")};c=c.buttons.exportData(b.exportOptions);var k,n;d=function(l){k=e+1;n=z(h,"row",{attr:{r:k}});for(var g=0,A=l.length;g<A;g++){for(var w=g,u="";0<=w;)u=String.fromCharCode(w%26+65)+u,w=Math.floor(w/26)-1;w=u+""+k;var q=null;if(null!==l[g]&&l[g]!==y&&""!==l[g]){l[g]=m.trim(l[g]);for(var B=0,H=O.length;B<H;B++)if(u=O[B],l[g].match&&!l[g].match(/^0\d+/)&&l[g].match(u.match)){q=l[g].replace(/[^\d\.\-]/g,"");u.fmt&&(q=u.fmt(q));
q=z(h,"c",{attr:{r:w,s:u.style},children:[z(h,"v",{text:q})]});break}q||("number"===typeof l[g]||l[g].match&&l[g].match(/^-?\d+(\.\d+)?$/)&&!l[g].match(/^0\d+/)?q=z(h,"c",{attr:{t:"n",r:w},children:[z(h,"v",{text:l[g]})]}):(u=l[g].replace?l[g].replace(/[\x00-\x09\x0B\x0C\x0E-\x1F\x7F-\x9F]/g,""):l[g],q=z(h,"c",{attr:{t:"inlineStr",r:w},children:{row:z(h,"is",{children:{row:z(h,"t",{text:u})}})}})));n.appendChild(q)}}p.appendChild(n);e++};m("sheets sheet",a.xl["workbook.xml"]).attr("name",R(b));b.customizeData&&
b.customizeData(c);b.header&&(d(c.header,e),m("row c",h).attr("s","2"));for(var f=0,x=c.body.length;f<x;f++)d(c.body[f],e);b.footer&&c.footer&&(d(c.footer,e),m("row:last c",h).attr("s","2"));d=z(h,"cols");m("worksheet",h).prepend(d);f=0;for(x=c.header.length;f<x;f++)d.appendChild(z(h,"col",{attr:{min:f+1,max:f+1,width:P(c,f),customWidth:1}}));b.customize&&b.customize(a);c=new (E||t.JSZip);d={type:"blob",mimeType:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"};K(c,a);c.generateAsync?
c.generateAsync(d).then(function(l){D(l,I(b));r.processing(!1)}):(D(c.generate(d),I(b)),this.processing(!1))},filename:"*",extension:".xlsx",exportOptions:{},header:!0,footer:!1};C.ext.buttons.pdfHtml5={className:"buttons-pdf buttons-html5",available:function(){return t.FileReader!==y&&(F||t.pdfMake)},text:function(a){return a.i18n("buttons.pdf","PDF")},action:function(a,c,d,b){this.processing(!0);var r=this;a=c.buttons.exportData(b.exportOptions);var e=[];b.header&&e.push(m.map(a.header,function(k){return{text:"string"===
typeof k?k:k+"",style:"tableHeader"}}));for(var h=0,p=a.body.length;h<p;h++)e.push(m.map(a.body[h],function(k){return{text:"string"===typeof k?k:k+"",style:h%2?"tableBodyEven":"tableBodyOdd"}}));b.footer&&a.footer&&e.push(m.map(a.footer,function(k){return{text:"string"===typeof k?k:k+"",style:"tableFooter"}}));a={pageSize:b.pageSize,pageOrientation:b.orientation,content:[{table:{headerRows:1,body:e},layout:"noBorders"}],styles:{tableHeader:{bold:!0,fontSize:11,color:"white",fillColor:"#2d4154",alignment:"center"},
tableBodyEven:{},tableBodyOdd:{fillColor:"#f3f3f3"},tableFooter:{bold:!0,fontSize:11,color:"white",fillColor:"#2d4154"},title:{alignment:"center",fontSize:15},message:{}},defaultStyle:{fontSize:10}};b.message&&a.content.unshift({text:"function"==typeof b.message?b.message(c,d,b):b.message,style:"message",margin:[0,0,0,12]});b.title&&a.content.unshift({text:S(b,!1),style:"title",margin:[0,0,0,12]});b.customize&&b.customize(a,b);c=(F||t.pdfMake).createPdf(a);"open"!==b.download||N()?c.getBuffer(function(k){k=
new Blob([k],{type:"application/pdf"});D(k,I(b));r.processing(!1)}):(c.open(),this.processing(!1))},title:"*",filename:"*",extension:".pdf",exportOptions:{},orientation:"portrait",pageSize:"A4",header:!0,footer:!1,message:null,customize:null,download:"download"};return C.Buttons});
