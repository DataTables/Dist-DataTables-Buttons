(function(g){"function"===typeof define&&define.amd?define(["jquery","datatables.net","datatables.net-buttons"],function(e){return g(e,window,document)}):"object"===typeof exports?module.exports=function(e,h){e||(e=window);if(!h||!h.fn.dataTable)h=require("datatables.net")(e,h).$;h.fn.dataTable.Buttons||require("datatables.net-buttons")(e,h);return g(h,e,e.document)}:g(jQuery,window,document)})(function(g,e,h,j){var m=g.fn.dataTable,k;if("undefined"!==typeof navigator&&/MSIE [1-9]\./.test(navigator.userAgent))k=
void 0;else{var y=e.document,p=y.createElementNS("http://www.w3.org/1999/xhtml","a"),F="download"in p,r=e.webkitRequestFileSystem,z=e.requestFileSystem||r||e.mozRequestFileSystem,G=function(a){(e.setImmediate||e.setTimeout)(function(){throw a;},0)},s=0,t=function(a){var c=function(){"string"===typeof a?(e.URL||e.webkitURL||e).revokeObjectURL(a):a.remove()};e.chrome?c():setTimeout(c,500)},u=function(a,c,d){for(var c=[].concat(c),b=c.length;b--;){var e=a["on"+c[b]];if("function"===typeof e)try{e.call(a,
d||a)}catch(i){G(i)}}},B=function(a){return/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(a.type)?new Blob(["﻿",a],{type:a.type}):a},C=function(a,c){var a=B(a),d=this,b=a.type,A=!1,i,g,h=function(){u(d,["writestart","progress","write","writeend"])},l=function(){if(A||!i)i=(e.URL||e.webkitURL||e).createObjectURL(a);g?g.location.href=i:e.open(i,"_blank")===j&&"undefined"!==typeof safari&&(e.location.href=i);d.readyState=d.DONE;h();t(i)},f=function(a){return function(){if(d.readyState!==
d.DONE)return a.apply(this,arguments)}},q={create:!0,exclusive:!1},n;d.readyState=d.INIT;c||(c="download");if(F)i=(e.URL||e.webkitURL||e).createObjectURL(a),p.href=i,p.download=c,b=y.createEvent("MouseEvents"),b.initMouseEvent("click",!0,!1,e,0,0,0,0,0,!1,!1,!1,!1,0,null),p.dispatchEvent(b),d.readyState=d.DONE,h(),t(i);else{e.chrome&&(b&&"application/octet-stream"!==b)&&(n=a.slice||a.webkitSlice,a=n.call(a,0,a.size,"application/octet-stream"),A=!0);r&&"download"!==c&&(c+=".download");if("application/octet-stream"===
b||r)g=e;z?(s+=a.size,z(e.TEMPORARY,s,f(function(b){b.root.getDirectory("saved",q,f(function(b){var e=function(){b.getFile(c,q,f(function(c){c.createWriter(f(function(b){b.onwriteend=function(a){g.location.href=c.toURL();d.readyState=d.DONE;u(d,"writeend",a);t(c)};b.onerror=function(){var a=b.error;a.code!==a.ABORT_ERR&&l()};["writestart","progress","write","abort"].forEach(function(a){b["on"+a]=d["on"+a]});b.write(a);d.abort=function(){b.abort();d.readyState=d.DONE};d.readyState=d.WRITING}),l)}),
l)};b.getFile(c,{create:false},f(function(a){a.remove();e()}),f(function(a){a.code===a.NOT_FOUND_ERR?e():l()}))}),l)}),l)):l()}},f=C.prototype;"undefined"!==typeof navigator&&navigator.msSaveOrOpenBlob?k=function(a,c){return navigator.msSaveOrOpenBlob(B(a),c)}:(f.abort=function(){this.readyState=this.DONE;u(this,"abort")},f.readyState=f.INIT=0,f.WRITING=1,f.DONE=2,f.error=f.onwritestart=f.onprogress=f.onwrite=f.onabort=f.onerror=f.onwriteend=null,k=function(a,c){return new C(a,c)})}var w=function(a,
c){var d="*"===a.filename&&"*"!==a.title&&a.title!==j?a.title:a.filename;"function"===typeof d&&(d=d());-1!==d.indexOf("*")&&(d=d.replace("*",g("title").text()));d=d.replace(/[^a-zA-Z0-9_\u00A1-\uFFFF\.,\-_ !\(\)]/g,"");return c===j||!0===c?d+a.extension:d},H=function(a){var c="Sheet1";a.sheetName&&(c=a.sheetName.replace(/[\[\]\*\/\\\?\:]/g,""));return c},I=function(a){a=a.title;"function"===typeof a&&(a=a());return-1!==a.indexOf("*")?a.replace("*",g("title").text()):a},x=function(a){return a.newline?
a.newline:navigator.userAgent.match(/Windows/)?"\r\n":"\n"},D=function(a,c){for(var d=x(c),b=a.buttons.exportData(c.exportOptions),e=c.fieldBoundary,i=c.fieldSeparator,g=RegExp(e,"g"),f=c.escapeChar!==j?c.escapeChar:"\\",l=function(a){for(var c="",b=0,d=a.length;b<d;b++)0<b&&(c+=i),c+=e?e+(""+a[b]).replace(g,f+e)+e:a[b];return c},h=c.header?l(b.header)+d:"",q=c.footer&&b.footer?d+l(b.footer):"",n=[],v=0,k=b.body.length;v<k;v++)n.push(l(b.body[v]));return{str:h+n.join(d)+q,rows:n.length}},E=function(){return-1!==
navigator.userAgent.indexOf("Safari")&&-1===navigator.userAgent.indexOf("Chrome")&&-1===navigator.userAgent.indexOf("Opera")},o={"_rels/.rels":'<?xml version="1.0" encoding="UTF-8" standalone="yes"?><Relationships xmlns="http://schemas.openxmlformats.org/package/2006/relationships">\t<Relationship Id="rId1" Type="http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument" Target="xl/workbook.xml"/></Relationships>',"xl/_rels/workbook.xml.rels":'<?xml version="1.0" encoding="UTF-8" standalone="yes"?><Relationships xmlns="http://schemas.openxmlformats.org/package/2006/relationships">\t<Relationship Id="rId1" Type="http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet" Target="worksheets/sheet1.xml"/></Relationships>',
"[Content_Types].xml":'<?xml version="1.0" encoding="UTF-8" standalone="yes"?><Types xmlns="http://schemas.openxmlformats.org/package/2006/content-types">\t<Default Extension="xml" ContentType="application/xml"/>\t<Default Extension="rels" ContentType="application/vnd.openxmlformats-package.relationships+xml"/>\t<Default Extension="jpeg" ContentType="image/jpeg"/>\t<Override PartName="/xl/workbook.xml" ContentType="application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml"/>\t<Override PartName="/xl/worksheets/sheet1.xml" ContentType="application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml"/></Types>',
"xl/workbook.xml":'<?xml version="1.0" encoding="UTF-8" standalone="yes"?><workbook xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:r="http://schemas.openxmlformats.org/officeDocument/2006/relationships">\t<fileVersion appName="xl" lastEdited="5" lowestEdited="5" rupBuild="24816"/>\t<workbookPr showInkAnnotation="0" autoCompressPictures="0"/>\t<bookViews>\t\t<workbookView xWindow="0" yWindow="0" windowWidth="25600" windowHeight="19020" tabRatio="500"/>\t</bookViews>\t<sheets>\t\t<sheet name="__SHEET_NAME__" sheetId="1" r:id="rId1"/>\t</sheets></workbook>',
"xl/worksheets/sheet1.xml":'<?xml version="1.0" encoding="UTF-8" standalone="yes"?><worksheet xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:r="http://schemas.openxmlformats.org/officeDocument/2006/relationships" xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" mc:Ignorable="x14ac" xmlns:x14ac="http://schemas.microsoft.com/office/spreadsheetml/2009/9/ac">\t<sheetData>\t\t__DATA__\t</sheetData></worksheet>'};m.ext.buttons.copyHtml5={className:"buttons-copy buttons-html5",
text:function(a){return a.i18n("buttons.copy","Copy")},action:function(a,c,d,b){var a=D(c,b),e=a.str,d=g("<div/>").css({height:1,width:1,overflow:"hidden",position:"fixed",top:0,left:0});b.customize&&(e=b.customize(e,b));b=g("<textarea readonly/>").val(e).appendTo(d);if(h.queryCommandSupported("copy")){d.appendTo(c.table().container());b[0].focus();b[0].select();try{h.execCommand("copy");d.remove();c.buttons.info(c.i18n("buttons.copyTitle","Copy to clipboard"),c.i18n("buttons.copySuccess",{1:"Copied one row to clipboard",
_:"Copied %d rows to clipboard"},a.rows),2E3);return}catch(i){}}a=g("<span>"+c.i18n("buttons.copyKeys","Press <i>ctrl</i> or <i>⌘</i> + <i>C</i> to copy the table data<br>to your system clipboard.<br><br>To cancel, click this message or press escape.")+"</span>").append(d);c.buttons.info(c.i18n("buttons.copyTitle","Copy to clipboard"),a,0);b[0].focus();b[0].select();var f=g(a).closest(".dt-button-info"),j=function(){f.off("click.buttons-copy");g(h).off(".buttons-copy");c.buttons.info(!1)};f.on("click.buttons-copy",
j);g(h).on("keydown.buttons-copy",function(a){27===a.keyCode&&j()}).on("copy.buttons-copy cut.buttons-copy",function(){j()})},exportOptions:{},fieldSeparator:"\t",fieldBoundary:"",header:!0,footer:!1};m.ext.buttons.csvHtml5={className:"buttons-csv buttons-html5",available:function(){return e.FileReader!==j&&e.Blob},text:function(a){return a.i18n("buttons.csv","CSV")},action:function(a,c,e,b){x(b);a=D(c,b).str;c=b.charset;b.customize&&(a=b.customize(a,b));!1!==c?(c||(c=h.characterSet||h.charset),c&&
(c=";charset="+c)):c="";k(new Blob([a],{type:"text/csv"+c}),w(b))},filename:"*",extension:".csv",exportOptions:{},fieldSeparator:",",fieldBoundary:'"',escapeChar:'"',charset:null,header:!0,footer:!1};m.ext.buttons.excelHtml5={className:"buttons-excel buttons-html5",available:function(){return e.FileReader!==j&&e.JSZip!==j&&!E()},text:function(a){return a.i18n("buttons.excel","Excel")},action:function(a,c,d,b){var f=g.parseXML(o["xl/worksheets/sheet1.xml"]),a=c.buttons.exportData(b.exportOptions),
c=function(a){var c=f.createElement("row");f.getElementsByTagName("sheetData")[0].appendChild(c);for(var b=0,e=a.length;b<e;b++){if(null===a[b]||a[b]===j)a[b]="";if("number"===typeof a[b]||a[b].match&&g.trim(a[b]).match(/^-?\d+(\.\d+)?$/)&&"0"!==a[b].charAt(0)){var d=f.createElement("c");d.setAttribute("t","n");var i=f.createElement("v"),h=f.createTextNode(a[b]);d.appendChild(i)}else{d=f.createElement("c");d.setAttribute("t","inlineStr");var k=f.createElement("is"),i=f.createElement("t"),h=f.createTextNode(!a[b].replace?
a[b]:a[b].replace(/&(?!amp;)/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/[\x00-\x09\x0B\x0C\x0E-\x1F\x7F-\x9F]/g,""));d.appendChild(k);k.appendChild(i)}i.appendChild(h);c.appendChild(d)}};b.customizeData&&b.customizeData(a);b.header&&c(a.header);for(var d=0,i=a.body.length;d<i;d++)c(a.body[d]);b.footer&&c(a.footer);var a=new e.JSZip,c=a.folder("_rels"),d=a.folder("xl"),i=a.folder("xl/_rels"),h=a.folder("xl/worksheets"),m=(new XMLSerializer).serializeToString(f);a.file("[Content_Types].xml",
o["[Content_Types].xml"]);c.file(".rels",o["_rels/.rels"]);d.file("workbook.xml",o["xl/workbook.xml"].replace("__SHEET_NAME__",H(b)));i.file("workbook.xml.rels",o["xl/_rels/workbook.xml.rels"]);h.file("sheet1.xml",m);k(a.generate({type:"blob",mimeType:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}),w(b))},filename:"*",extension:".xlsx",exportOptions:{},header:!0,footer:!1};m.ext.buttons.pdfHtml5={className:"buttons-pdf buttons-html5",available:function(){return e.FileReader!==
j&&e.pdfMake},text:function(a){return a.i18n("buttons.pdf","PDF")},action:function(a,c,d,b){x(b);a=c.buttons.exportData(b.exportOptions);c=[];b.header&&c.push(g.map(a.header,function(a){return{text:"string"===typeof a?a:a+"",style:"tableHeader"}}));for(var f=0,d=a.body.length;f<d;f++)c.push(g.map(a.body[f],function(a){return{text:"string"===typeof a?a:a+"",style:f%2?"tableBodyEven":"tableBodyOdd"}}));b.footer&&c.push(g.map(a.footer,function(a){return{text:"string"===typeof a?a:a+"",style:"tableFooter"}}));
a={pageSize:b.pageSize,pageOrientation:b.orientation,content:[{table:{headerRows:1,body:c},layout:"noBorders"}],styles:{tableHeader:{bold:!0,fontSize:11,color:"white",fillColor:"#2d4154",alignment:"center"},tableBodyEven:{},tableBodyOdd:{fillColor:"#f3f3f3"},tableFooter:{bold:!0,fontSize:11,color:"white",fillColor:"#2d4154"},title:{alignment:"center",fontSize:15},message:{}},defaultStyle:{fontSize:10}};b.message&&a.content.unshift({text:b.message,style:"message",margin:[0,0,0,12]});b.title&&a.content.unshift({text:I(b,
!1),style:"title",margin:[0,0,0,12]});b.customize&&b.customize(a,b);a=e.pdfMake.createPdf(a);"open"===b.download&&!E()?a.open():a.getBuffer(function(a){a=new Blob([a],{type:"application/pdf"});k(a,w(b))})},title:"*",filename:"*",extension:".pdf",exportOptions:{},orientation:"portrait",pageSize:"A4",header:!0,footer:!1,message:null,customize:null,download:"download"};return m.Buttons});
