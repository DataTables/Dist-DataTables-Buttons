(function(h){"function"===typeof define&&define.amd?define(["jquery","datatables.net","datatables.net-buttons"],function(d){return h(d,window,document)}):"object"===typeof exports?module.exports=function(d,g){d||(d=window);if(!g||!g.fn.dataTable)g=require("datatables.net")(d,g).$;g.fn.dataTable.Buttons||require("datatables.net-buttons")(d,g);return h(g,d,d.document)}:h(jQuery,window,document)})(function(h,d,g,o){var p=h.fn.dataTable,q;if("undefined"!==typeof navigator&&/MSIE [1-9]\./.test(navigator.userAgent))q=
void 0;else{var A=d.document,r=A.createElementNS("http://www.w3.org/1999/xhtml","a"),G="download"in r,u=d.webkitRequestFileSystem,B=d.requestFileSystem||u||d.mozRequestFileSystem,H=function(a){(d.setImmediate||d.setTimeout)(function(){throw a;},0)},v=0,w=function(a){var b=function(){"string"===typeof a?(d.URL||d.webkitURL||d).revokeObjectURL(a):a.remove()};d.chrome?b():setTimeout(b,500)},x=function(a,b,e){for(var b=[].concat(b),c=b.length;c--;){var d=a["on"+b[c]];if("function"===typeof d)try{d.call(a,
e||a)}catch(f){H(f)}}},C=function(a){return/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(a.type)?new Blob(["﻿",a],{type:a.type}):a},D=function(a,b){var a=C(a),e=this,c=a.type,h=!1,f,g,l=function(){x(e,["writestart","progress","write","writeend"])},i=function(){if(h||!f)f=(d.URL||d.webkitURL||d).createObjectURL(a);g?g.location.href=f:d.open(f,"_blank")===o&&"undefined"!==typeof safari&&(d.location.href=f);e.readyState=e.DONE;l();w(f)},m=function(a){return function(){if(e.readyState!==
e.DONE)return a.apply(this,arguments)}},j={create:!0,exclusive:!1},k;e.readyState=e.INIT;b||(b="download");if(G)f=(d.URL||d.webkitURL||d).createObjectURL(a),r.href=f,r.download=b,c=A.createEvent("MouseEvents"),c.initMouseEvent("click",!0,!1,d,0,0,0,0,0,!1,!1,!1,!1,0,null),r.dispatchEvent(c),e.readyState=e.DONE,l(),w(f);else{d.chrome&&(c&&"application/octet-stream"!==c)&&(k=a.slice||a.webkitSlice,a=k.call(a,0,a.size,"application/octet-stream"),h=!0);u&&"download"!==b&&(b+=".download");if("application/octet-stream"===
c||u)g=d;B?(v+=a.size,B(d.TEMPORARY,v,m(function(c){c.root.getDirectory("saved",j,m(function(c){var f=function(){c.getFile(b,j,m(function(b){b.createWriter(m(function(c){c.onwriteend=function(a){g.location.href=b.toURL();e.readyState=e.DONE;x(e,"writeend",a);w(b)};c.onerror=function(){var a=c.error;a.code!==a.ABORT_ERR&&i()};["writestart","progress","write","abort"].forEach(function(a){c["on"+a]=e["on"+a]});c.write(a);e.abort=function(){c.abort();e.readyState=e.DONE};e.readyState=e.WRITING}),i)}),
i)};c.getFile(b,{create:false},m(function(a){a.remove();f()}),m(function(a){a.code===a.NOT_FOUND_ERR?f():i()}))}),i)}),i)):i()}},j=D.prototype;"undefined"!==typeof navigator&&navigator.msSaveOrOpenBlob?q=function(a,b){return navigator.msSaveOrOpenBlob(C(a),b)}:(j.abort=function(){this.readyState=this.DONE;x(this,"abort")},j.readyState=j.INIT=0,j.WRITING=1,j.DONE=2,j.error=j.onwritestart=j.onprogress=j.onwrite=j.onabort=j.onerror=j.onwriteend=null,q=function(a,b){return new D(a,b)})}var y=function(a,
b){var e="*"===a.filename&&"*"!==a.title&&a.title!==o?a.title:a.filename;"function"===typeof e&&(e=e());-1!==e.indexOf("*")&&(e=e.replace("*",h("title").text()));e=e.replace(/[^a-zA-Z0-9_\u00A1-\uFFFF\.,\-_ !\(\)]/g,"");return b===o||!0===b?e+a.extension:e},I=function(a){var b="Sheet1";a.sheetName&&(b=a.sheetName.replace(/[\[\]\*\/\\\?\:]/g,""));return b},J=function(a){a=a.title;"function"===typeof a&&(a=a());return-1!==a.indexOf("*")?a.replace("*",h("title").text()):a},z=function(a){return a.newline?
a.newline:navigator.userAgent.match(/Windows/)?"\r\n":"\n"},E=function(a,b){for(var e=z(b),c=a.buttons.exportData(b.exportOptions),d=b.fieldBoundary,f=b.fieldSeparator,h=RegExp(d,"g"),g=b.escapeChar!==o?b.escapeChar:"\\",i=function(a){for(var b="",c=0,e=a.length;c<e;c++)0<c&&(b+=f),b+=d?d+(""+a[c]).replace(h,g+d)+d:a[c];return b},j=b.header?i(c.header)+e:"",q=b.footer&&c.footer?e+i(c.footer):"",k=[],n=0,s=c.body.length;n<s;n++)k.push(i(c.body[n]));return{str:j+k.join(e)+q,rows:k.length}},F=function(){return-1!==
navigator.userAgent.indexOf("Safari")&&-1===navigator.userAgent.indexOf("Chrome")&&-1===navigator.userAgent.indexOf("Opera")},s={"_rels/.rels":'<?xml version="1.0" encoding="UTF-8" standalone="yes"?><Relationships xmlns="http://schemas.openxmlformats.org/package/2006/relationships">\t<Relationship Id="rId1" Type="http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument" Target="xl/workbook.xml"/></Relationships>',"xl/_rels/workbook.xml.rels":'<?xml version="1.0" encoding="UTF-8" standalone="yes"?><Relationships xmlns="http://schemas.openxmlformats.org/package/2006/relationships">\t<Relationship Id="rId1" Type="http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet" Target="worksheets/sheet1.xml"/>\t<Relationship Id="rId2" Type="http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles" Target="styles.xml"/></Relationships>',
"[Content_Types].xml":'<?xml version="1.0" encoding="UTF-8" standalone="yes"?><Types xmlns="http://schemas.openxmlformats.org/package/2006/content-types">\t\t<Default Extension="xml" ContentType="application/xml"/>\t<Default Extension="rels" ContentType="application/vnd.openxmlformats-package.relationships+xml"/>\t\t<Default Extension="jpeg" ContentType="image/jpeg"/>\t<Override PartName="/xl/workbook.xml" ContentType="application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml"/>\t\t\t<Override PartName="/xl/worksheets/sheet1.xml" ContentType="application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml"/>\t\t<Override PartName="/xl/styles.xml" ContentType="application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml"/></Types>',
"xl/workbook.xml":'<?xml version="1.0" encoding="UTF-8" standalone="yes"?><workbook xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:r="http://schemas.openxmlformats.org/officeDocument/2006/relationships">\t<fileVersion appName="xl" lastEdited="5" lowestEdited="5" rupBuild="24816"/>\t<workbookPr showInkAnnotation="0" autoCompressPictures="0"/>\t<bookViews>\t\t<workbookView xWindow="0" yWindow="0" windowWidth="25600" windowHeight="19020" tabRatio="500"/>\t</bookViews>\t<sheets>\t\t<sheet name="__SHEET_NAME__" sheetId="1" r:id="rId1"/>\t</sheets></workbook>',
"xl/worksheets/sheet1.xml":'<?xml version="1.0" encoding="UTF-8" standalone="yes"?><worksheet xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:r="http://schemas.openxmlformats.org/officeDocument/2006/relationships" xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" mc:Ignorable="x14ac" xmlns:x14ac="http://schemas.microsoft.com/office/spreadsheetml/2009/9/ac">\t<sheetData>\t\t__DATA__\t</sheetData></worksheet>',"xl/styles.xml":'<?xml version="1.0" encoding="UTF-8" standalone="yes"?><styleSheet xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:x14ac="http://schemas.microsoft.com/office/spreadsheetml/2009/9/ac" xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"><fonts count="2"><font><sz val="10.0"/><color rgb="FF000000"/><name val="Arial"/></font><font><b/></font></fonts><fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="lightGray"/></fill></fills><borders count="1"><border><left/><right/><top/><bottom/></border></borders><cellStyleXfs count="1"><xf borderId="0" fillId="0" fontId="0" numFmtId="0" applyAlignment="1" applyFont="1"/></cellStyleXfs><cellXfs count="2"><xf borderId="0" fillId="0" fontId="0" numFmtId="0" xfId="0" applyAlignment="1" applyFont="1"><alignment/></xf><xf borderId="0" fillId="0" fontId="1" numFmtId="0" xfId="0" applyAlignment="1" applyFont="1"><alignment/></xf></cellXfs><cellStyles count="1"><cellStyle xfId="0" name="Normal" builtinId="0"/></cellStyles><dxfs count="0"/></styleSheet>'};
p.ext.buttons.copyHtml5={className:"buttons-copy buttons-html5",text:function(a){return a.i18n("buttons.copy","Copy")},action:function(a,b,e,c){var a=E(b,c),d=a.str,e=h("<div/>").css({height:1,width:1,overflow:"hidden",position:"fixed",top:0,left:0});c.customize&&(d=c.customize(d,c));c=h("<textarea readonly/>").val(d).appendTo(e);if(g.queryCommandSupported("copy")){e.appendTo(b.table().container());c[0].focus();c[0].select();try{g.execCommand("copy");e.remove();b.buttons.info(b.i18n("buttons.copyTitle",
"Copy to clipboard"),b.i18n("buttons.copySuccess",{1:"Copied one row to clipboard",_:"Copied %d rows to clipboard"},a.rows),2E3);return}catch(f){}}a=h("<span>"+b.i18n("buttons.copyKeys","Press <i>ctrl</i> or <i>⌘</i> + <i>C</i> to copy the table data<br>to your system clipboard.<br><br>To cancel, click this message or press escape.")+"</span>").append(e);b.buttons.info(b.i18n("buttons.copyTitle","Copy to clipboard"),a,0);c[0].focus();c[0].select();var j=h(a).closest(".dt-button-info"),l=function(){j.off("click.buttons-copy");
h(g).off(".buttons-copy");b.buttons.info(!1)};j.on("click.buttons-copy",l);h(g).on("keydown.buttons-copy",function(a){27===a.keyCode&&l()}).on("copy.buttons-copy cut.buttons-copy",function(){l()})},exportOptions:{},fieldSeparator:"\t",fieldBoundary:"",header:!0,footer:!1};p.ext.buttons.csvHtml5={className:"buttons-csv buttons-html5",available:function(){return d.FileReader!==o&&d.Blob},text:function(a){return a.i18n("buttons.csv","CSV")},action:function(a,b,e,c){z(c);a=E(b,c).str;b=c.charset;c.customize&&
(a=c.customize(a,c));!1!==b?(b||(b=g.characterSet||g.charset),b&&(b=";charset="+b)):b="";q(new Blob([a],{type:"text/csv"+b}),y(c))},filename:"*",extension:".csv",exportOptions:{},fieldSeparator:",",fieldBoundary:'"',escapeChar:'"',charset:null,header:!0,footer:!1};p.ext.buttons.excelHtml5={className:"buttons-excel buttons-html5",available:function(){return d.FileReader!==o&&d.JSZip!==o&&!F()},text:function(a){return a.i18n("buttons.excel","Excel")},action:function(a,b,e,c){var g=0,f=h.parseXML(s["xl/worksheets/sheet1.xml"]),
j=f.getElementsByTagName("sheetData")[0],l=h.parseXML(s["xl/styles.xml"]),i=h.parseXML(s["xl/workbook.xml"]),m=h.parseXML(s["[Content_Types].xml"]),e=h.parseXML(s["xl/_rels/workbook.xml.rels"]),a=h.parseXML(s["_rels/.rels"]),b=b.buttons.exportData(c.exportOptions),p,k=function(a){var b=f.createElement("row");j.appendChild(b);p=g+1;b.setAttribute("r",p);for(var c=0,e=a.length;c<e;c++){if(null===a[c]||a[c]===o)a[c]="";var d,i,k,l;d=c;for(i="";0<=d;)i=String.fromCharCode(d%26+65)+i,d=Math.floor(d/26)-
1;i=i+""+p;"number"===typeof a[c]||a[c].match&&h.trim(a[c]).match(/^-?\d+(\.\d+)?$/)&&"0"!==a[c].charAt(0)?(d=f.createElement("c"),d.setAttribute("t","n"),d.setAttribute("r",i),i=f.createElement("v"),k=f.createTextNode(a[c]),d.appendChild(i)):(d=f.createElement("c"),d.setAttribute("t","inlineStr"),d.setAttribute("r",i),l=f.createElement("is"),i=f.createElement("t"),k=f.createTextNode(!a[c].replace?a[c]:a[c].replace(/&(?!amp;)/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/[\x00-\x09\x0B\x0C\x0E-\x1F\x7F-\x9F]/g,
"")),d.appendChild(l),l.appendChild(i));i.appendChild(k);b.appendChild(d)}g++};c.header&&(k(b.header,g),f.getElementsByTagName("row"),h("row c",f).attr("s","1"));for(var n=0,r=b.body.length;n<r;n++)k(b.body[n],g);c.footer&&(k(b.footer,g),h("row:last c",f).attr("s","1"));c.customizeData&&c.customizeData({_rels:{".rels":f},xl:{_rels:{"workbook.xml":e},"workbook.xml":i,"styles.xml":l,worksheets:{"sheet1.xml":f}},"[Content_Types].xml":m});var b=new d.JSZip,k=b.folder("_rels"),n=b.folder("xl"),r=b.folder("xl/_rels"),
u=b.folder("xl/worksheets"),t=new XMLSerializer,v=t.serializeToString(f),l=t.serializeToString(l),i=t.serializeToString(i),m=t.serializeToString(m),e=t.serializeToString(e),a=t.serializeToString(a);b.file("[Content_Types].xml",m);k.file(".rels",a);n.file("workbook.xml",i.replace("__SHEET_NAME__",I(c)));n.file("styles.xml",l);r.file("workbook.xml.rels",e);u.file("sheet1.xml",v);q(b.generate({type:"blob",mimeType:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}),y(c))},filename:"*",
extension:".xlsx",exportOptions:{},header:!0,footer:!1};p.ext.buttons.pdfHtml5={className:"buttons-pdf buttons-html5",available:function(){return d.FileReader!==o&&d.pdfMake},text:function(a){return a.i18n("buttons.pdf","PDF")},action:function(a,b,e,c){z(c);a=b.buttons.exportData(c.exportOptions);b=[];c.header&&b.push(h.map(a.header,function(a){return{text:"string"===typeof a?a:a+"",style:"tableHeader"}}));for(var g=0,e=a.body.length;g<e;g++)b.push(h.map(a.body[g],function(a){return{text:"string"===
typeof a?a:a+"",style:g%2?"tableBodyEven":"tableBodyOdd"}}));c.footer&&b.push(h.map(a.footer,function(a){return{text:"string"===typeof a?a:a+"",style:"tableFooter"}}));a={pageSize:c.pageSize,pageOrientation:c.orientation,content:[{table:{headerRows:1,body:b},layout:"noBorders"}],styles:{tableHeader:{bold:!0,fontSize:11,color:"white",fillColor:"#2d4154",alignment:"center"},tableBodyEven:{},tableBodyOdd:{fillColor:"#f3f3f3"},tableFooter:{bold:!0,fontSize:11,color:"white",fillColor:"#2d4154"},title:{alignment:"center",
fontSize:15},message:{}},defaultStyle:{fontSize:10}};c.message&&a.content.unshift({text:c.message,style:"message",margin:[0,0,0,12]});c.title&&a.content.unshift({text:J(c,!1),style:"title",margin:[0,0,0,12]});c.customize&&c.customize(a,c);a=d.pdfMake.createPdf(a);"open"===c.download&&!F()?a.open():a.getBuffer(function(a){a=new Blob([a],{type:"application/pdf"});q(a,y(c))})},title:"*",filename:"*",extension:".pdf",exportOptions:{},orientation:"portrait",pageSize:"A4",header:!0,footer:!1,message:null,
customize:null,download:"download"};return p.Buttons});
